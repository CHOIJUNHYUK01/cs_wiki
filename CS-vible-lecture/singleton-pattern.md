# 싱글톤 패턴

> 하나의 클래스에 오직 하나의 인스턴스만 가지는 패턴이다.

인스턴스 생성에 많은 코스트가 드는 데이터베이스 연결 모듈에 많이 쓰인다.
그래서 인스턴스 생성을 효율적으로 한다는 장점이 있다.

그러나 의존성이 높아지고 TDD를 할 때, 불편한 단점이 있다.
TDD는 단위 테스트를 할 때 주로 사용한다.
그러나, 단위 테스트할 때 사용하는 데이터를 독립적으로 인스턴스를 만들어 사용해야 한다.
이를 싱글톤으로 구현했다면, 이가 힘들기 때문이다.

### 생성 방법 (JAVA 기준)

1. 싱글톤 인스턴스가 없다면 만들고, 있다면 기존 인스턴스를 반환한다.

> 멀티스레드 환경에서는 2개가 될 수 있음

2. `synchronized`키워드로 잠금을 해, 최초 접근한 스레드가 끝내야 다른 스레드가 호출이 가능하도록 만든다.

> 하지만 이 경우 lock 때문에 성능 저하가 일어날 수 있음

3. 정적 멤버를 활용한다. 모든 클래스를 로드할 때 미리 생성하는 방법이다.

> 불필요한 자원 낭비다. 필요없는 경우에도 인스턴스가 만들어지기 때문이다.

4. Lazy Holder(중첩 클래스), 즉 내부 클래스를 하나 더 만들어, 인스턴스가 필요할 때 만든다.

> 추천하는 방식 중 하나다.

5. 이중 확인 잠금 (DCL, Double Checked Locking)

> 싱글톤 패턴 잠금 전에 한 번, 객체를 생성하기 전에 한 번 체크해서 인스턴스가 존재하지 않을 경우에만 잠금을 건다.

6. enum의 인스턴스를 활용한다.

> 스레드 세이프 (thread safe)한 점이 보장되기 때문에 이를 통해 생성한다. `조슈아 블로크`가 추천한 방법이다.
