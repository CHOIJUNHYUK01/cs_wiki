# TCP/IP 4계층

> 장치들이 인터넷 상에서 데이터를 주고받을 때 쓰는 독립적인 프로토콜의 집합이다. TCP/IP는 Transmission Control Protocol / Internet Protocol 이라는 의미인데 인터넷을 통해 데이터를 보낼 때 주로 TCP와 IP를 이용해서 보내기 때문에 이런 용어를 가진다.

Application : SMTP, HTTP/HTTPS, FTP, SSH
Transport : UDP, TCP
Internet : IPv4, IPv6, ICMP, ARP
Network Access : 링크 계층이라고도 불린다.

### 애플리케이션 계층

HTTP, SMTP, SSH, FTP가 대표적이다.
웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층이다.

### 전송 계층

TCP, UDP가 대표적이다.
애플리케이션 계층에서 받은 메시지를 기반으로 세그먼트 또는 데이터그램으로 데이터를 쪼개고 데이터가 오류없이 순서대로 전달되도록 도움을 주는 층이다.

### 인터넷 계층

IP, ICMP, ARP가 대표적이다.
한 노드에서 다른 노드로 전송 계층에서 받은 세그먼트 또는 데이터그램을 패킷화하여 목적지로 전송하는 역할을 담당한다.

### 링크 계층

전선, 광섬유, 무선 등으로 데이터가 네트워크를 통해 물리적으로 전송되는 방식을 정의한다.
데이터 링크 계층과 물리 계층을 합친 계층이다.

### 캡슐화와 비캡슐화

`캡슐화`

송신자가 수신자에게 데이터를 보낼 때, 데이터가 각 계층을 지나며 각 계층의 특징들이 담긴 헤더들이 붙여지는 과정이다.
예를 들어, 전송 계층은 TCP 헤더를, 네트워크 계층은 IP 헤더를 추가하는 것이다.

`비캡슐화`

캡슐화 과정의 역과정이다.
수신자 측에서는 이렇게 캡슐화된 데이터를 역순으로 제거하면서, 응용 계층까지 도달하는 것을 말한다.

### PDU (protocol data unit)

> TCP/IP 4계층을 기반으로 설명했을 때, 각 계층의 데이터 단위를 의미한다.

애플리케이션 계층 : 메세지
전송 계층 : 세그먼트(TCP), 데이터그램(UDP)
인터넷 계층 : 패킷
링크 계층 : 프레임(데이터 링크 계층), 비트(물리 계층)

`세그먼트`

적절한 크기로 쪼갠 조각이다.
세그먼트와 데이터그램의 의미는 같다.

`패킷`

세그먼트에 SP와 DP가 포함된 IP 헤더가 붙은 형태의 조각이다.

(IPv4 기준)
SP : 송신자의 32비트 IP주소
DP : 수신자의 32비트 IP주소

`프레임`

MAC 주소 헤더와 CRC/체크섬 트레일러가 붙은 조각이다.

### CRC/체크섬 트레일러

> 데이터 오류감지를 위한 수학적 함수가 적용된 값들이 있는 필드다. 링크의 오류(과도한 트래픽 등)로 인해 데이터 손상을 감지하는 역할을 한다. 이 과정에서 CRC와 체크섬 두 과정을 기반으로 데이터 전송 오류 및 데이터 무결성을 방지하게 된다.

CRC : CRC-1, CRC-16 등의 알고리즘으로 나온 값을 통해 데이터 전송오류감지를 수행한다.
체크섬 : MD5, SHA-256 등의 알고리즘으로 나온 값을 통해 데이터 무결성을 방지한다.

참고로 모든 계층에 전달되는 데이터가 쪼개져서 "패킷"으로 전달된다고도 하는 것도 대강 맞는 말이나,
PDU에 따라 부르는 게 더 맞는 표현이다.

### OSI 7계층

TCP/IP 4계층은 OSI 7계층 모델로 설명하기도 한다.
OSI 계층은 애플리케이션 계층을 세 개로 쪼개고, 링크 계층을 데이터 링크 계층, 물리 계층으로 나눠서 표현한다.
인터넷 계층을 네트워크 계층으로 부른다.

`OSI 7 Layer` -> `TCP/IP`

Application Layer
Presentation Layer -> Application Layer
Session Layer

Transport Layer -> Transport Layer

Network Layer -> Internet Layer

Data-Link Layer -> Network Access Layer
Physical Layer
