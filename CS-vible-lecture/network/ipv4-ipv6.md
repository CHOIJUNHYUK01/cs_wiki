# IPv4와 IPv6

> IP주소는 인터넷 주소로, IPv4와 IPv6로 나눠진다.

### IPv4

> 32비트로 표현되는 주소체계다. 2의 32승 개의 주소(41억 9천만)를 표현할 수 있다. 8비트 단위로 점을 찍어 4개로 구분해 표현하며, 보통 8비트를 10진수로 표현해 말한다.

이 주소체계만으로는 부족하기 때문에 NAT, 서브네팅 등 여러 개의 부수적인 기술이 생겨났다.

### IPv6

> 128비트로 표현되는 주소체계다. 2의 128승 개의 주소를 표현할 수 있다. 많은 주소 처리가 가능해 NAT, 서브네팅이 필요하지 않다. 16비트씩 8개로 구분하고, 16비트는 16진수로 변환되어 콜론(:)으로 구분해 표시한다. 앞의 연속되는 0은 생략될 수 있다.

앞의 64비트는 네트워크 주소를 말하고, 뒤 64비트는 인터페이스 주소로 이뤄져 있다.

`IPSec이 내장됨`

이는 데이터 페킷을 암호화하는 보안 네트워크 프로토콜 제품군이다.
이 제품군이 IPv6에 내장되어 있다.

`단순해진 헤더 포맷`

IPv6는 IPv4 헤더에서 불필요한 필드를 제거해 보다 빠른 처리가 가능하다.

### 체크섬

IPv4에는 있지만, IPv6에는 없다.

IPv4에는 CRC를 통한 손상된 패킷을 확인하고, 폐기하는데 쓰는 체크섬 필드가 있다.

    CRC란?

    순환중복검사로 네트워크상에서 데이터에 오류가 있는지 확인하기 위한 체크값을 결정하는 방식이다.

    데이터를 전송하기 전에 주어진 데이터의 값에 따라 CRC 값을 계산해 데이터에 붙여 전송하고,
    데이터 전송이 끝난 후에 받은 데이터 값으로 다시 CRC 값을 계산하게 된다.

    이어서 두 값을 비교하고, 이 두 값이 다르면 데이터 전송 과정에서 잡음 등에 의해 오류가 덧붙여 전송된 것임을 알 수 있다.

IPv6는 해당 체크섬 필드가 존재하지 않는다.
왜냐하면, 상위 프로토콜(TCP, UDP)에 체크섬 필드가 있기 떄문이다.
헤더의 효율화를 위해 버전이 업그레이드되면서 사라졌기 때문이다.

만약 체크섬 필드를 사용하지 않는 것으로 설정하고 싶다면, 해당 필드 값을 모두 0으로 만들면 된다.
이를 통해 체크섬 필드를 유동적으로 사용하거나 사용하지 않게 할 수 있다.

다만, `IPv6 + UDP`로 사용할 경우에는 IPv6 헤더내에는 체크섬 필드가 없기에 무조건 UDP 헤더의 체크섬 필드를 사용한다고 설정해야 한다.

### 헤더길이

IPv4 헤더는 가변길이다.

IPv6 헤더는 고정길이(40바이트)다. 그리고 "인터넷 헤더길이"에 대한 정보가 없다.
이외에도 여러가지 불필요한 정보가 삭제되어 있다.

### TTL과 HOP limit

`TTL`

IPv4에서 TTL 필드는 패킷이 네트워크에서 무한순환하지 않도록 하는 변수다.
패킷이 네트워크에서 라우터를 거칠 때마다 TTL 값이 1씩 감소한다.
값이 0이 되면 패킷이 폐기된다.

이와 같은 행동을 하는 게 IPv6에서는 `HOP limit`이라고 한다.

### IPv4와 IPv6 중 어떤게 좋나요? 뭐가 더 빠른가요?

IPv6가 IPv4보다 많은 주소를 표현할 수 있다.
또한 IPv4보다 불필요한 헤더가 삭제되어 빠르고 기본적으로 IPSec이라는 네트워크 보안제품군이 포함되어 있어서 보안적인 측면에서도 더 좋다.

보통은 IPv6를 사용하는 게 IPv4보다 속도가 더 빠르지만, 일부 사용사례에서는 속도가 느린 경우가 있을 수 있다.
